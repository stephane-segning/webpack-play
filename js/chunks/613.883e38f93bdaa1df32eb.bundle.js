"use strict";(self.webpackChunkwebpack_play=self.webpackChunkwebpack_play||[]).push([[613,97],{613:(t,e,n)=>{n.r(e),n.d(e,{TodoList:()=>i});var a=n(143),d=n(701),s=n(97);class o extends a.Ay{constructor(t){super(t),this.version(1).stores({todos:"++id,name,data"})}}class i extends HTMLElement{get db(){return this._db}constructor(){super()}connectedCallback(){this.initStorage(),this.render()}initStorage(){const t=this.getAttribute("x-prefix");this._db=new o(t)}async render(){const t=new d.t([]),e=this.attachShadow({mode:"open"}),n=await this._db.todos.toArray();t.next(n);const a=document.createElement("div");a.classList.add("list"),e.appendChild(a);const o=document.createElement("div");o.classList.add("menu");const i=await(0,s.addButton)("Add todo",(async()=>{const e=await this.db.todos.add({data:"Some wrong text",name:"Some title"}),n=await this.db.todos.get(e);t.next([...t.value,n])}));o.appendChild(i),e.appendChild(o),t.asObservable().subscribe({next:e=>{a.innerHTML="",e.forEach((async e=>{a.appendChild(await this.getListItem(e,(()=>{this._db.todos.delete(e.id),t.next(t.value.filter((t=>t!==e)))})))}))}})}async getListItem(t,e){const n=document.createElement("div"),a=document.createElement("h3");a.innerText=t.name,n.appendChild(a);const d=document.createElement("p");d.innerText=t.data,n.appendChild(d);const o=await(0,s.addButton)("Remove todo",(()=>{n.remove(),e()}));return n.appendChild(o),n}attributeChangedCallback(t){console.log(`Attribute ${t} has changed.`),"x-prefix"===t&&this.initStorage()}}window.customElements.define("todo-list",i)},97:(t,e,n)=>{async function a(t,e){const n=document.createElement("button");return n.innerText=t,n.addEventListener("click",e),n}n.r(e),n.d(e,{addButton:()=>a})}}]);